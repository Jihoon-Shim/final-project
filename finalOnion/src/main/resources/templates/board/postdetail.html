<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/layout}" 
>
<head>
<title>BuyForm</title>
</head>
 <div layout:fragment="main">
<button type="button" id="update" >수정</button>    
<button type="button" id="delete">삭제</button>    
<table class="table" style="overflow:auto;">
	<thead>
		<tr bgcolor="#DDDDDD">
			<td th:text="${tvo.boardTitle}">제목</td>	
			<td th:text="${tvo.boardDate}">작성날짜</td>	
			<td th:text="${tvo.tradePrice}">가격</td>
			<td th:text="${tvo.hits}">조회수</td>
			<td th:text="${tvo.memberVO.memberNickname}">작성자</td>
		</tr>
	</thead>
	<tbody>
		<tr bgcolor="#FFFFFF">
			<td><img th:src="@{/myweb/images/}+${tvo.productPicture}" width=100%;>	</td>
			<td colspan="3"><pre><font size="4" ><span class="box" th:text=${tvo.boardContent}></span></font></pre>
			<form th:action="@{/profile}" method="post">
				<input type="hidden" name="otherNick" th:value="${tvo.memberVO.memberNickname}">
				<th:block th:if="${#authentication.getPrincipal().getMemberId()}!=${tvo.memberVO.memberId}">
				<button type="submit" th:text="|${tvo.memberVO.memberNickname}님과 채팅|">작성자와 채팅</button>
				</th:block>
				
			</form>
			</td>
		</tr>
	</tbody>
</table>
<script type="text/javascript"  th:inline="javascript">
	$(document).ready(function(){
		let username = [[${#authentication.principal.memberId}]];
		let postname = [[${tvo.memberVO.memberId}]];
		$("#update").click(function(){
			if(username!=postname){
				alert("본인의 글만 수정할 수 있습니다.");
			}else{
				location.href="/board/updatePostForm?boardNo="+[[${tvo.boardNo}]];
			}
		})
		$("#delete").click(function(){
			if(username!=postname){
				alert("본인의 글만 삭제할 수 있습니다.");
			}else{
				location.href="/board/deletePost";
			}
		})
	})
</script>
 </div>

</html>